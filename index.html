<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>UNO Online</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    .uno-active {
      animation: pulse 1s infinite;
    }
    .card {
      width: 4rem;
      height: 6rem;
      border-radius: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0.25rem;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body class="bg-green-600 flex flex-col min-h-screen p-4">

  <!-- Jogador 1 -->
  <div id="player1" class="flex flex-wrap justify-center mb-8"></div>

  <!-- Área central com descarte, compra e botão UNO -->
  <div class="flex justify-center items-center mb-8 relative">
    <div id="draw-pile" class="w-24 h-36 bg-blue-700 text-white rounded-lg flex items-center justify-center cursor-pointer mx-4">
      Compra
    </div>
    <div id="discard-pile" class="w-24 h-36 border-2 border-gray-300 rounded-lg flex items-center justify-center mx-4"></div>
    <button id="uno-button" class="absolute right-0 w-24 h-36 bg-yellow-400 rounded-lg text-black font-bold hidden">
      UNO!
    </button>
  </div>

  <!-- Jogador 2 -->
  <div id="player2" class="flex flex-wrap justify-center mt-8"></div>

  <audio id="sound-play" src="https://www.soundjay.com/buttons/sounds/button-16.mp3"></audio>
  <audio id="sound-draw" src="https://www.soundjay.com/buttons/sounds/button-10.mp3"></audio>
  <audio id="sound-uno" src="https://www.soundjay.com/buttons/sounds/button-3.mp3"></audio>

  <script>
    const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9];
    const colors = ["red", "blue", "green", "yellow"];
    const deck = [];

    colors.forEach(color => {
      numbers.forEach(num => {
        deck.push({ number: num, color });
      });
    });

    for (let i = 0; i < 4; i++) {
      deck.push({ number: '+4', color: 'black' });
      deck.push({ number: 'Coringa', color: 'wild' });
    }

    deck.sort(() => Math.random() - 0.5);

    const player1 = [];
    const player2 = [];
    const discardPile = document.getElementById("discard-pile");
    const unoButton = document.getElementById("uno-button");
    let currentPlayer = 1;

    for (let i = 0; i < 7; i++) {
      player1.push(deck.pop());
      player2.push(deck.pop());
    }

    function renderHands() {
      const p1 = document.getElementById("player1");
      const p2 = document.getElementById("player2");
      p1.innerHTML = "";
      p2.innerHTML = "";

      player1.forEach((card, index) => {
        const el = document.createElement("div");
        el.className = `card bg-${card.color}-500`;
        el.textContent = card.number;
        if (currentPlayer === 1) {
          el.onclick = () => playCard(card, index, player1);
        } else {
          el.classList.add("opacity-50");
        }
        p1.appendChild(el);
      });

      player2.forEach((card, index) => {
        const el = document.createElement("div");
        el.className = `card bg-${card.color}-500`;
        el.textContent = card.number;
        if (currentPlayer === 2) {
          el.onclick = () => playCard(card, index, player2);
        } else {
          el.classList.add("opacity-50");
        }
        p2.appendChild(el);
      });
    }

    function playCard(card, index, hand) {
      const topCard = discardPile.dataset.card ? JSON.parse(discardPile.dataset.card) : null;
      if (
        card.number === 'Coringa' ||
        !topCard ||
        card.color === topCard.color ||
        card.number === topCard.number ||
        card.number === '+4'
      ) {
        document.getElementById("sound-play").play();
        discardPile.textContent = card.number;
        discardPile.style.backgroundColor = card.color === 'black' ? 'gray' : card.color;
        discardPile.dataset.card = JSON.stringify(card);
        hand.splice(index, 1);
        if (hand.length === 1) {
          unoButton.classList.remove("hidden");
          unoButton.classList.add("uno-active");
          setTimeout(() => {
            if (!unoButton.classList.contains("hidden")) {
              hand.push(deck.pop(), deck.pop());
              unoButton.classList.add("hidden");
              unoButton.classList.remove("uno-active");
              renderHands();
            }
          }, 5000);
        }
        endTurn();
      } else {
        alert("Carta inválida!");
      }
    }

    function endTurn() {
      unoButton.classList.add("hidden");
      unoButton.classList.remove("uno-active");
      currentPlayer = currentPlayer === 1 ? 2 : 1;
      renderHands();
    }

    document.getElementById("draw-pile").onclick = () => {
      const hand = currentPlayer === 1 ? player1 : player2;
      const newCard = deck.pop();
      hand.push(newCard);
      document.getElementById("sound-draw").play();
      renderHands();
      endTurn();
    };

    unoButton.onclick = () => {
      document.getElementById("sound-uno").play();
      unoButton.classList.add("hidden");
      unoButton.classList.remove("uno-active");
      alert("UNO declarado!");
    };

    const firstCard = deck.pop();
    discardPile.textContent = firstCard.number;
    discardPile.style.backgroundColor = firstCard.color;
    discardPile.dataset.card = JSON.stringify(firstCard);

    renderHands();
  </script>
</body>
</html>
